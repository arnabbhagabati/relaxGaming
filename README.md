# Relax Gaming Take Home Assignment

## Pre-Requisites
1. Relatively new version of JDK. (This application has been tested with JDK ver. 23.)
2. Maven Build Tool (Tested with Maven version 8.32)

## Build & Run
1. Execute  `mvn clean install` from the root directory to build the jar.
2. Execute `java -Dfile.encoding=UTF-8 -Dsun.stdout.encoding=UTF-8 -Dsun.stderr.encoding=UTF-8 -jar target/relax-game-0.0.1-SNAPSHOT.jar` to run the application.

## How to Play
1. By default, the application will run on port `8080` with base URL `http://localhost:8080/relax`
2. This application exposes 2 endpoints:
    - **GET** `/spinGame` — Runs a simulation of the game that detects all clusters, triggers the avalance calculate the wins  
      Accepts a request parameter `betAmount` to input the bet amount.
    - **GET** `/gambleChoice/{gameId}` — Triggers the gamble at the end after all clusters have been evaluated and there are no more wins.  
      Accepts a game ID as a path parameter.

### /spinGame
**Example Endpoint:** `http://localhost:8080/relax/spinGame?betAmount=22`

Returns JSON with the game simulation, showing the grid, symbols forming clusters, grid after avalanche, new incoming symbols after avalanche and final payout.  
This json can be used to render the entire gameplay on the frontend.  

**Returns a Json with below structure:**
1. **betAmount** — The bet amount passed by the user.
2. **gameId** — Unique game ID generated by the backend. Can be used to trigger the gambleChoice endpoint later.
3. **playerId** — Fixed value `'player1'` (login/authentication not implemented in this exercise).
4. **initialGrid** — The initial 8×8 grid generated with symbols to start the game (2D JSON array).
5. **gameCycles** — A 2D Json array of "game cycle" objects, with each object containing
    - **gridWithClusters** — The 8x8 Grid with all clusters marked (2D JSON array).
    - **clusters** — List of clusters identified along with the contituent cell co-ordinates
    - **gridPostAvalanche** — Grid after destroying the clusters clusters triggering the avalanche
    - **refillGrid** — A 2D Json Array representing the new symbols falling down on empty positions
    - **gridPostRefill** — A 2D Json Array representing the state of the grid after new symbols have been filled
    - **payout** — Payout for the given cycle.
6. **payout** — Final payout after all avalanche cycles.
7. **status** — "PENDING_GAMBLE" - Indicating that the final gamble for this game has not been played yet.

### /gambleChoice/{gameId}
**Example Endpoint:** `http://localhost:8080/relax/gambleChoice/<gameId>`  where `<gameId>` is the gameId returned by `/spinGame` endpoint  
Triggers a gamble choice after all wins are calculated, and returns the win amount(RTP) as a number with a 50% chance to double the win or lose it entirely.


## Assumptions
1. If a cluster has 5 symbols and one of them is a WR, only 4 symbols are eligible for payout; hence, no payout is given.  
   However, it is still treated as a cluster for game flow (triggering avalanches).
2. Betting amount accepts whole numbers only (no fractional amounts).


## Notes
The application also "pretty-prints" the states of the grid to the console's standard output throughout the gameplay  
This makes viewing the game progress and grid states easier, since the JSON output in some clients may not be formatted nicely.
