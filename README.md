# Relax Gaming Take Home Assignment

## Pre-Requisites
1. Relatively new version of JDK. (This application has been tested with JDK ver. 23.)
2. Maven Build Tool (Tested with Maven version 8.32)

## Build & Run
1. Execute
   ```bash
   mvn clean install
   ```  
   from the root directory to build the jar.
2. Execute
   ```bash
   java -Dfile.encoding=UTF-8 -Dsun.stdout.encoding=UTF-8 -Dsun.stderr.encoding=UTF-8 -jar target/relax-game-0.0.1-SNAPSHOT.jar
   ```  
   to run the application.

## How to Play
1. By default, the application will run on port `8080` with base URL:
   ```
   http://localhost:8080/relax
   ```
2. This application exposes 2 endpoints:
    - **GET** `/spinGame` — Runs a simulation of the game that detects all clusters.  
      Accepts a request parameter `betAmount` to input the bet amount.
    - **GET** `/gambleChoice/{gameId}` — Triggers the gamble at the end after all clusters have been evaluated and there are no more wins.  
      Accepts a game ID as a path parameter.

---

### `/spinGame`
**Example Endpoint:**
```
http://localhost:8080/relax/spinGame?betAmount=22
```
or
```bash
curl http://localhost:8080/relax/spinGame?betAmount=22
```

**Description:**  
Returns JSON with the game simulation, showing:
- The grid
- Symbols forming clusters
- Grid after avalanche
- New incoming symbols after avalanche
- Final payout

**Returned JSON fields:**
1. **betAmount** — The bet amount passed by the user.
2. **gameId** — Unique game ID generated by the backend. Can be used to trigger the gamble endpoint later.
3. **playerId** — Fixed value `'player1'` (login/authentication not implemented in this exercise).
4. **initialGrid** — Initial 8×8 grid generated with symbols to start the game (2D JSON array).
5. **gameCycles** — Array of game cycles where each cycle represents:
    - **gridWithClusters** — Grid with all clusters marked (2D JSON array).
    - **clusters** — List of clusters with the cells for each cluster.
    - **gridPostAvalanche** — Grid after destroying clusters and avalanche (2D JSON array).
    - **refillGrid** — New symbols falling into empty positions (2D JSON array).
    - **gridPostRefill** — State of grid after refill (2D JSON array).
    - **payout** — Payout for the given cycle.
6. **payout** — Final payout after all avalanche cycles.
7. **status** — Indicates that the final gamble has not been played yet.

---

### `/gambleChoice/{gameId}`
**Example Endpoint:**
```
http://localhost:8080/relax/gambleChoice/<gameId>
```
or
```bash
curl http://localhost:8080/relax/gambleChoice/<gameId>
```
where `<gameId>` is the one returned by `/spinGame`.

**Description:**  
Triggers a gamble choice after all wins are calculated, with a 50% chance to double the win or lose it entirely.

---

## Assumptions
1. If a cluster has 5 symbols and one of them is a WR, only 4 symbols are eligible for payout; hence, no payout is given.  
   However, it is still treated as a cluster for game flow (avalanche).
2. Betting amount accepts whole numbers only (no fractional amounts).

---

## Notes
The application also **pretty-prints** the `/spinGame` output to the console.  
This makes the game progress and grid states easier to view, since the JSON output from some clients may not be formatted nicely.
