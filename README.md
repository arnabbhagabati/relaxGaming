# Relax Gaming take home Assignment

## Assumptions
1. If a cluster has 5 symbols, and one of them is a WR, that makes only 4 symbols eligible for payout, hence no payout is given.  
    However, it is still treated as a cluster for the game flow (evalance)
2. Betting amount for each game accepts whole number values only and not fractional amounts


## Pre-Requisites
1. Relatively new version of JDK.(This application has been tested with JDK ver. 23.)
2. Maven Build Tool (Tested with Maven version 8.32)

## Build & Run 
1. Execute  `mvn clean install` from root directory to build the jar.
2. Execute `java -Dfile.encoding=UTF-8 -Dsun.stdout.encoding=UTF-8 -Dsun.stderr.encoding=UTF-8 -jar target/relax-game-0.0.1-SNAPSHOT.jar` to run the application

## How to Play
1. By default application will  run on port 8080 with base url http://localhost:8080/relax
2. This application exposes 2 endpoints 
    GET /spinGame      - this runs a simulation of the game that detects all the clusters. It accepts a request parameter `betAmount` to input the bet amount 
    GET /gambleChoice  - this triggers the gamble at the end after all clusters have been evaluated and there are no more wins. Accepts a game id as path parameter 

### spinGame
Example Endpoint - http://localhost:8080/relax/spinGame?betAmount=22 or curl - `curl http://localhost:8080/relax/spinGame?betAmount=22`
It returns a Json with the Game simulation,  showing the grid, symbols forming clusters, grid after avalanche, new incoming symbols after avalanche and final payout.  
This json can be used to render the entire gameplay on the frontend
The return Json Contents these fields
   1. betAmount - The betamount that was passed by the user
   2. gameId    - game id for the game generated by the backend. This can be used to trigger the double or nothing gamble choice endpoint later 
   3. playerId  - Login/Authorization has not been implemented for the purpose of this exercise. This field just contains a fixed value 'player1'
   4. initialGrid - the initila 8x8 grid generated with the symbols to start the game. Represented by a 2 dimensional Json Array
   5. gameCycles  - An Array of 'cycle' where each cycle represents Identification of clusters in the grid, destruction of the symbols and avalance, refilling the grid with new symbols falling down
                    It contains the below fields
                    a. gridWithClusters - A 2 dimensional Json Array representing the grid with all the clusters marked 
                    b. clusters	     - A Json representation of the clusters identified, with list of the cells for each cluster
                    c. gridWPostAvalanche -  A 2 dimensional Json Array representing the grid after the clusters are destroyed and avalance has happened
                    d. refillGrid		   -  A 2 dimensional Json Array representing the new symbols falling down on empty positions
                    e. gridPostRefill     -  A 2 dimensional Json Array representing the state of the grid after new symbols have been filled
                    f. payout             - Payout for the given cycle
   6. payout      - Final payout calculated after all the avalanche cycles
   7. status      - field indicating the last gamble has not been played yet.


### gambleChoice
This endpoint can be used to trigger the gamble choice after all the wins have been calculated, should the user choose to.
Example Endpoint - http://localhost:8080/relax/gambleChoice/<gameId> or curl - `curl http://localhost:8080/relax/gambleChoice/<gameId>`, where gameId is the one returned by the /spinGame enapoint in earlier section
This endpoint returns a number that represents the win amount after the gamble; 2 times the win amount or 0 with 50% probability


## Notes
The application also prints the values of the output of `/spinGame` endpoint to the console, in formated nicely as a grid.
This should make the viewing of the game progress and grid states easier, compared to viewing the Json output of the endpoint

                     